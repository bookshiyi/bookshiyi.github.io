---
title: NRF24L01多通道（多对一）调试心得
tags:
  - NRF24L01
  - 多通道
  - 嵌入式
  - 无线通讯
url: 1048.html
id: 1048
comments: false
categories:
  - 单片机
  - 嵌入式
  - 软件设计
date: 2016-08-25 17:25:03
---

        在射频界，NRF24L01绝对是一块神奇的芯片，凭借超高的性价比独占市场鳌头许多年，但是他的内部寄存器配置相比之下是略显复杂的。

        对于一对一收发的情况，网络上的资源比较多，本文在此就不再制造互联网垃圾了。进图今天的正题：**NRF24L01多通道（多对一）调试**。

![NRF24L01地址设置](http://oarap.org/wp-content/uploads/2016/08/NRF24L01地址设置.png)

        上图来自**官方**的数据手册，国人翻译版的手册里面也有这个图，可是根本看不清啊有木有。

        这是一种基于硬件的多通道通信方式，占用较窄的频带和拥有较高的接收效率，在对数据的实时性要求较高或各节点发送数据额频度不一致（这样主机接收到数据将主要来自于发送频度较高的节点）的情况下这种方式是应该被提倡的，多通道工作模式最多允许六台从机和一台主机可以同时工作在同一频道（即相同的载波频率），

####         一.**收发端相同的设置：**

        收发主机必须工作在同一频道（相同的载波频率）且空中速率和发射功率要相同；

        发送机发送的数据长度应和接收主机对应的接收通道的数据长度相等，否则接收主机无法确认来自该通道的数据是否完整；

####         **二.在接收端的设置：**

        1.使能所有的接收通道；

        2.在接收主机的RX\_ADDR\_P0到RX\_ADDR\_P5分别设置不同的接收地址（个人认为叫通道地址更贴切），在写入通道0和通道1的接收地址时是五个字节的长度，**写入通道2-5的接收地址时是1个字节的长度，通道2-5的高四字节与通道1相同，![NRF24L01多通道的地址](http://oarap.org/wp-content/uploads/2016/08/NRF24L01多通道的地址.png)**

另外**先写低字节后写高字节**一定要注意。

        3.【PRX】接收主机还需设置每个通道相应的的数据宽度（即每个通道每帧数据的字节数）。

        4.配置主机为接收模式

####         **三.发送端的配置**

        1.如文中的第一张图所示，写入从机的RX\_ADDR\_P0(无论是哪个从机都仅向自己的RX\_ADDR\_P0寄存器写入接收地址)，再向TX\_ADDR写入发送地址，在从机端的RX\_ADDR\_P0和TX\_ADDR是相同的，目的是能接收到应答，且从机端写入的地址与主机的第几个通道相同便确定从机工作在第几个通道。

        2.设置从机为发送模式

![NRF24L01状态寄存器](http://oarap.org/wp-content/uploads/2016/08/NRF24L01状态寄存器.png)

        在数据处理的时候主要依靠NRF24L01的SATUS寄存器中的RX\_P\_NO三位来确定当前接收到哪个通道的数据以及是否接收到数据。

体会与总结：

仔细研读数据手册是十分有必要的，最好是官方原版（起码图片能看清楚啊！），如果阅读困难也推荐中英双语的数据手册对照着看，很多词汇在中文语境下不容易理解，相比之下英文版手册中的一些词汇的描述是十分准确不容易产生歧义的。